<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lookup-Table Syntax Options in Javascript | yield ✴️ star</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/blog/logo.png">
    <meta name="description" content="A few ways to create lookup-tables in Javascript">
    <meta name="keywords" content="Lookup-Tables in Javascript">
    
    <link rel="preload" href="/blog/assets/css/0.styles.da135087.css" as="style"><link rel="preload" href="/blog/assets/js/app.51892fbd.js" as="script"><link rel="preload" href="/blog/assets/js/3.efec7c88.js" as="script"><link rel="preload" href="/blog/assets/js/28.7f8d5e9a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.ee735fed.js"><link rel="prefetch" href="/blog/assets/js/11.493f7ca4.js"><link rel="prefetch" href="/blog/assets/js/12.00bfbad9.js"><link rel="prefetch" href="/blog/assets/js/13.4830997c.js"><link rel="prefetch" href="/blog/assets/js/14.7f0820ec.js"><link rel="prefetch" href="/blog/assets/js/15.9a1ec982.js"><link rel="prefetch" href="/blog/assets/js/16.b0f82e18.js"><link rel="prefetch" href="/blog/assets/js/17.ce08f3c6.js"><link rel="prefetch" href="/blog/assets/js/18.969d81ce.js"><link rel="prefetch" href="/blog/assets/js/19.f3478df0.js"><link rel="prefetch" href="/blog/assets/js/20.1982a9c0.js"><link rel="prefetch" href="/blog/assets/js/21.64fd1855.js"><link rel="prefetch" href="/blog/assets/js/22.6650308e.js"><link rel="prefetch" href="/blog/assets/js/23.0eb786a4.js"><link rel="prefetch" href="/blog/assets/js/24.71cb0686.js"><link rel="prefetch" href="/blog/assets/js/25.7595b861.js"><link rel="prefetch" href="/blog/assets/js/26.a1978bd7.js"><link rel="prefetch" href="/blog/assets/js/27.845744e5.js"><link rel="prefetch" href="/blog/assets/js/29.5ee113ff.js"><link rel="prefetch" href="/blog/assets/js/30.606d8f8d.js"><link rel="prefetch" href="/blog/assets/js/31.a5b8c883.js"><link rel="prefetch" href="/blog/assets/js/32.c9297017.js"><link rel="prefetch" href="/blog/assets/js/33.0cd81b0a.js"><link rel="prefetch" href="/blog/assets/js/4.a9f51df5.js"><link rel="prefetch" href="/blog/assets/js/5.53478f95.js"><link rel="prefetch" href="/blog/assets/js/6.c0bdc117.js"><link rel="prefetch" href="/blog/assets/js/7.5209bb80.js"><link rel="prefetch" href="/blog/assets/js/8.22f16ff3.js"><link rel="prefetch" href="/blog/assets/js/9.9798b7d6.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.9f78e3e8.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.da135087.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><script>
  function recaptchaCallback(){
      document.querySelector('section form input[type=submit]').removeAttribute('disabled');
  }
  function dismissJoin(e, str){
    if(str === 'success') {
      (window || globalThis).localStorage.setItem('joinedwjv', 'success')
      setTimeout(function() { document.querySelector('#ContactMe').remove() }, 200)
    } else{
      return document.querySelector('#ContactMe').remove()
    }
  }
</script> <header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="yield ✴️ star" class="logo"> <span class="site-name can-hide">yield ✴️ star</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Menu</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/" class="nav-link">Home</a></li><li class="dropdown-item"><!----> <a href="/blog/posts/" class="nav-link router-link-active">Posts</a></li><li class="dropdown-item"><!----> <a href="/blog/archive/" class="nav-link">Archive</a></li><li class="dropdown-item"><!----> <a href="https://wjv.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Portfolio
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/jamievaughn/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Menu</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/" class="nav-link">Home</a></li><li class="dropdown-item"><!----> <a href="/blog/posts/" class="nav-link router-link-active">Posts</a></li><li class="dropdown-item"><!----> <a href="/blog/archive/" class="nav-link">Archive</a></li><li class="dropdown-item"><!----> <a href="https://wjv.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Portfolio
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/jamievaughn/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <!----> </div> <div class="blog" data-v-0a184ec8><section id="ContactMe" href="#ContactMe" data-v-0a372c70 data-v-0a184ec8><form id="ajax-contact" method="post" action="https://getsimpleform.com/messages?form_api_token=8d73f78e270ace7eeda7529329d6a348" class="post" data-v-0a372c70><input type="hidden" data-v-0a372c70> <h3 data-v-0a372c70>Join for updates by email! <span onclick="dismissJoin()" class="dismiss" data-v-0a372c70>╳</span></h3> <div id="form-feedback" class="hidden" data-v-0a372c70>Submitted successfully! Thank you! I'll be in touch shortly.</div> <input name="name" type="name" id="name" required="required" data-v-0a372c70> <label for="name" class="name" data-v-0a372c70>Your Name:</label> <input name="email" type="email" id="email" pattern=".+@+.+\.[a-z]{2,5}$" required="required" data-v-0a372c70> <label for="email" class="email" data-v-0a372c70>Your Email:</label> <div class="controls" data-v-0a372c70><div data-sitekey="6Ldh-8kUAAAAAMYG8-BxodEZ4zxcn9uV8H4LKMOd" data-callback="recaptchaCallback" class="g-recaptcha" data-v-0a372c70></div> <input type="submit" onsubmit="postMsg" onclick="dismissJoin(event, 'success')" disabled="disabled" data-v-0a372c70></div></form> <script src="https://www.google.com/recaptcha/api.js" async="async" defer="defer" data-v-0a372c70></script></section> <div class="blog__header" data-v-0a184ec8><p class="publish-date" data-v-0a184ec8><time datetime="2020-07-20T08:50:00.000Z" data-v-0a184ec8>July 20, 2020</time></p> <p data-v-0a184ec8>Time to read: 8 min read</p> <h1 class="blog__title" data-v-0a184ec8>Lookup-Table Syntax Options in Javascript</h1></div> <div class="custom content__default" data-v-0a184ec8><p>Most event-based programming, whether it is for UI or not, needs a way to map some list of actions or inputs to blocks of logic to execute. Procedural Programming may not need this because the entire program is expected to run synchronously and in order. But when responding to events, code will not execute in a predictable order, which requires a good way to organize the possible blocks of logic that may need to run at these asynchronous times. The Asynchronicity, itself, is handled by other patterns (Promises, Futures, Observables Pub/Sub, etc.), but for organizing the callbacks of these patterns, lets take a look at some lookup-table implementation patterns. These patterns appear commonly in state management libraries like Redux and XState to manage state, dispatchers, and actions which may be triggered or transformed within a user interface.</p> <h2 id="a-few-options-for-authoring-lookup-tables-in-js"><a href="#a-few-options-for-authoring-lookup-tables-in-js" class="header-anchor">#</a> A Few Options for Authoring Lookup-Tables in JS</h2> <ul><li>If statements (conventional or ternary)</li> <li>Switch Statements</li> <li>Objects/Maps (Lookup-Tables)</li></ul> <p>First we have the humble <code>if</code> statement control flow implementation in both conventional and ternary syntax:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getSound</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> test <span class="token operator">===</span> <span class="token string">'cat'</span> <span class="token operator">?</span> <span class="token string">'meow'</span> <span class="token operator">:</span> 
         test <span class="token operator">===</span> <span class="token string">'cow'</span> <span class="token operator">?</span> <span class="token string">'moo'</span> <span class="token operator">:</span> 
         test <span class="token operator">===</span> <span class="token string">'dog'</span> <span class="token operator">?</span> <span class="token string">'woof'</span> <span class="token operator">:</span> 
         test <span class="token operator">===</span> <span class="token string">'bird'</span> <span class="token operator">?</span> <span class="token string">'chirp'</span> <span class="token operator">:</span> 
         test <span class="token operator">===</span> <span class="token string">'frog'</span> <span class="token operator">?</span> <span class="token string">'ribit'</span> <span class="token operator">:</span> 
         <span class="token string">'silence'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Or the same logic but with conventional <code>if</code> / <code>else if</code> / <code>else</code> syntax:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getSoundConv</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'cat'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'meow'</span> 
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'cow'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'moo'</span> 
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'dog'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'woof'</span> 
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'bird'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'chirp'</span> 
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'frog'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'ribit'</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token string">'silence'</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Control flow implementations necessarily introduces <a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity" target="_blank" rel="noopener noreferrer">cyclomatic complexity<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> meaning there is branching logic within one's code. This is considered somewhat of a code smell in the Functional Paradigm because it imposes a cost on code readability. The next two implementations avoid the control flow pattern and thus reduce cyclomatic complexity. They make it eaiser to map pieces of UI directly to blocks of logic, rather than routing multiple UI element events through one imperative block of logic that the control flow must untangle.</p> <p>The first of the &quot;non-control flow&quot; options is a lookup-table implemented via a <code>switch</code> statement:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">switchSound</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'cat'</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">'meow'</span>
    <span class="token keyword">case</span> <span class="token string">'dog'</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">'woof'</span>
    <span class="token keyword">case</span> <span class="token string">'cow'</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">'moo'</span>
    <span class="token keyword">case</span> <span class="token string">'bird'</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">'chirp'</span>
    <span class="token keyword">case</span> <span class="token string">'frog'</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">'ribit'</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">'silence'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And next we have an example of a lookup-table function using a simple object factory:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">factorySound</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    cat<span class="token operator">:</span> <span class="token string">'meow'</span><span class="token punctuation">,</span>
    dog<span class="token operator">:</span> <span class="token string">'woof'</span><span class="token punctuation">,</span>
    cow<span class="token operator">:</span> <span class="token string">'moo'</span><span class="token punctuation">,</span>
    bird<span class="token operator">:</span> <span class="token string">'chirp'</span><span class="token punctuation">,</span>
    frog<span class="token operator">:</span> <span class="token string">'ribit'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">[</span>str<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string">'silence'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above implementation uses a factory function that returns plain JS objects, but would look about the same using a Map() or WeakMap(). An easy extra optimization that can be made with this approach is defining the object externally to the function in order to limit how many of these objects are created in memory. Then the function is simply a getter for that object, essentially.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// same obj as above just defined outside function.</span>
<span class="token keyword">const</span> Animals <span class="token operator">=</span> <span class="token punctuation">{</span>cat<span class="token operator">:</span> <span class="token string">'meow'</span><span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">}</span> 
<span class="token keyword">function</span> <span class="token function">factorySound</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Animals<span class="token punctuation">[</span>str<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string">'silence'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Going this route suggests that the factorySound function could be abstracted to a general <code>factoryValue</code> function and could be used on any object that you define in your application:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">factoryValue</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token keyword">default</span> <span class="token operator">=</span> <span class="token string">'silence'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>str<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token keyword">default</span>
<span class="token punctuation">}</span>
</code></pre></div><p>All four of the functions above will provide an easy API for retrieving values by passing in a simple enum.
We can test the functions with something simple to inspect their output and we would get something like this:</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getSound</span><span class="token punctuation">(</span><span class="token string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// 'woof'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getSoundConv</span><span class="token punctuation">(</span><span class="token string">'cow'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// 'moo'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">switchSound</span><span class="token punctuation">(</span><span class="token string">'cat'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// 'meow'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">factorySound</span><span class="token punctuation">(</span><span class="token string">'snake'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'silence'</span>
</code></pre></div><h3 id="which-to-favor"><a href="#which-to-favor" class="header-anchor">#</a> Which to favor?</h3> <p>This is subjective as any of the styles work in the expected way. The decision of which to use comes down to two things, I think: (1) Readability and (2) Extensibility.</p> <p>In my opinion, both of the <code>if</code> statement styles are the least readable. The conventional <code>if</code> statement style would at least offer you better extensibility over the ternary style since you can more easily use multi-line code for more complex logic. But the extensibility is matched or exceeded by the switch and factory styles, so I think it's safe to lay the <code>if</code> statement style aside in favor of one of the next two styles.</p> <p>Between the <code>switch</code> style and the factory style, I think there is a fair argument to be made for both. The object factory style's advantage is that, as an object, it is quite literally a map or a key-value store. So it is the thing we set out to recreate, meaning what we see is what we want it to be and not some adaptation or hack. So in terms of readability, I'd give the edge to the oject factory table syntax.</p> <p>In terms of extensibility, both the <code>switch</code> and facotry styles permit multi-line space for complex execution logic. Both can be adapted to use a more declarative style over an imperative style by returning a function instead of executing procedural logic in place. The switch statement <code>case</code> block and the factory table allow convenient non-co-located function definitions to be mapped to the keys or <code>case</code> block without being invoked inline. So both permit easily passing function callbacks around our program for lazy execution and taking better advantage of closures. And both equally reduce cyclomatic complexity by mapping an enum directly to a block of logic, which reduces code branching unlike the <code>if</code> statements.</p> <p>Perhaps the key distinction is the <code>switch</code> statement has more flexibility than the factory table by not being constrained only to enums as the access API. The <code>switch</code> statement can also accomodate comparisons to map to execution blocks, which may suit one's program in particular situations. In most situations enums are prefered for readability and are usually good enough, but having the additional flexibility of comparators may explain why <code>switch</code> statements seem more popular in Reducer utilities, like React's <code>useReducer</code> and Redux, within the functional community.</p> <h3 id="use-cases"><a href="#use-cases" class="header-anchor">#</a> Use Cases</h3> <p>A common use case for this pattern is for mapping blocks of code to execute for each UI element that triggers an event. A pitfall that leads to unnecessary cyclomatic complexity is relying on a single function as a callback when any one of an entire set of buttons is clicked. This callback would typically work out which code to execute within the function by using control flow to check either some background global state or checking some flag parameter that is passed in.</p> <p>The lookup-table pattern lets us separate out the logic of determining which code block to execute into its own structure (i.e. one of the lookup functions above). Then the return value from that lookup-table funciton would, ultimately, be the code block that needs to be executed as a result of the triggering event. Emerging from this pattern is that the control flow mentioned in the previous paragraph simply falls away if the UI is setup accordingly. The UI element can contain the enum value that will be passed in the event object that bubbles and the lookup-table can retrieve the correct function without any control flow using the event object properties. This is what is meant by &quot;pushing cyclomatic complexity out&quot;. The logic branching still technically exists in the program, but we've pushed it all the way into the UI layer (instead of it being in the business logic layer) which simplifies our code. Since the branch now implicitly occurs before the moment of user input, the branch logic never explicitly appears in the code itself.</p> <h5 id="an-example"><a href="#an-example" class="header-anchor">#</a> An Example</h5> <p>Let's take a simple contrived example of a drop down menu:</p> <p>The HTML might be something like this:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>choices<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Listen to an animal's call:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>choices<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>choices<span class="token punctuation">&quot;</span></span> 
  <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>factorySound(event.target.value)<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dog<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Dog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cat<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Cat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bird<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Bird/option&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Cow<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bear<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Bear<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>animal<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selection<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>And the javascript can use one of our lookup-tables from before, which you'll notice we can easily extend with a new <code>bear</code> field. We can also keep unused fields without consequence, like <code>frog</code>, which might be used in another UI component but won't be used in this one, and it will safely be inert here:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">factorySound</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    cat<span class="token operator">:</span> <span class="token function">soundAction</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'meow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    dog<span class="token operator">:</span> <span class="token function">soundAction</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'woof'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cow<span class="token operator">:</span> <span class="token function">soundAction</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'moo'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    bird<span class="token operator">:</span> <span class="token function">soundAction</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'chirp'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    frog<span class="token operator">:</span> <span class="token function">soundAction</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'ribit'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    bear<span class="token operator">:</span> <span class="token function">soundAction</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'roar'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">[</span>str<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token function">soundAction</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'silence'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">soundAction</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> sound</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sound<span class="token punctuation">)</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#selection'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://pictureof</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>str<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.com/200/300</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We've also added a new function called <code>soundAction</code>, which can be the composable function that holds the actual business logic code block that should be run upon the event being triggered. It can contain any arbitrary logic, and of course different functions can be mapped to different lookup-table fields as needed for customizability. In this example, the busines logic just logs the animal sound and populates an image of the animal from a hypothetical animal picture API.</p> <p>With this kind of organization (which resembles the formalized Command Pattern), you'll notice there are no if statements and no conventional control flow which means we keep our cyclomatic complexity to a minimum. We've pushed all of the logic branching up the UI layer (which is as high as it can go) and we allow the event system itself to pass the information needed to run the correct code block.</p></div> <div class="page-edit" data-v-0a184ec8><!----> <!----></div> <!----> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.51892fbd.js" defer></script><script src="/blog/assets/js/3.efec7c88.js" defer></script><script src="/blog/assets/js/28.7f8d5e9a.js" defer></script>
  </body>
</html>
